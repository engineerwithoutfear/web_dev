<!DOCTYPE html>

<html>

<head>
  <title>URL Shortener</title>
  <link rel="shortcut icon" href="https://cdn.hyperdev.com/us-east-1%3A52a203ff-088b-420f-81be-45bf559d01b1%2Ffavicon.ico"
    type="image/x-icon" />
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
  <link href="/public/style.css" rel="stylesheet" type="text/css">
</head>

<body>
  <div class="container">
    <h2>API Project: URL Shortener Microservice</h2>

    <h3>User Story: </h3>
    <ol>
      <li>I can POST a URL to <code>[project_url]/api/shorturl/new</code> and I will receive a shortened URL in the JSON response.<br>Example
        : <code>{"original_url":"www.google.com","short_url":1}</code></li>
      <li>If I pass an invalid URL that doesn't follow the <code>http(s)://www.example.com(/more/routes)</code> format, the JSON
        response will contain an error like <code>{"error":"invalid URL"}</code><br> HINT: to be sure that the submitted
        url points to a valid site you can use the function <code>dns.lookup(host, cb)</code> from the <code>dns</code> core
        module.</li>
      <li>When I visit the shortened URL, it will redirect me to my original link.</li>
    </ol>

    <h3>Short URL Creation </h3>
    <p>
      example: <code>POST [project_url]/api/shorturl/new</code> - <code>https://www.google.com</code>
    </p>
    <form name="muhForm">
      <label for="url_input">URL to be shortened</label>
      <input id="url_input" type="text" name="url" value="https://www.free-code-camp.com">
      <input type="submit" id="submission" value="POST URL" name="muhForm2">
    </form>
    <div id="results"></div>

  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script>
    $(function () {

      $('#submission').click(function () {
        console.log($('input#url_input').val())
        $.ajax({
          url: 'api/shorturl/new',
          type: 'post',
          dataType: 'json',
          data: $('input#url_input').serialize(),
          success: function (data) {
            console.log(data)
            var formattedURL = "/api/shorturl/" + data.shortURL;
            // $("form").hide()
            $("#results").append(data.fullURL + " => <a href=" + formattedURL + ">" + location.hostname +
              formattedURL + "</a>")
          },
          error: function (xhr) {

            console.log("error!!" + xhr.status + " " + xhr.statusText)
          }
        })

        return false;
      })


    })
  </script>
</body>

</html>